‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è Async Handler Function ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è


// utils/asyncHandler.ts

üëç‚Äî-------------------First Way ‚Äî------------------------------------üëç
import { Request, Response, NextFunction } from "express";

export const asyncHandler = (
  fn: (req: Request, res: Response, next: NextFunction) => Promise<any>
) => (req: Request, res: Response, next: NextFunction) => {
  Promise.resolve(fn(req, res, next)).catch(next);
};


üëç‚Äî-------------------Second  Way ‚Äî------------------------------------üëç
import { Request, Response, NextFunction } from "express";

export const asyncHandler = (
  fn: (req: Request, res: Response, next: NextFunction) => Promise<any>
) => {
  return (req: Request, res: Response, next: NextFunction) => {
    fn(req, res, next).catch(next); // automatically pass errors to next()
  };
};


üëç‚Äî-------------------Third  Way ‚Äî------------------------------------üëç


import { NextFunction, Request, RequestHandler, Response } from "express"

const asyncHandler = (fn: RequestHandler)=>{
    return (req: Request, res:Response, next:NextFunction)=>{
      Promise.resolve(fn(req, res, next)).catch((err)=> next(err))
    }
}

export default asyncHandler;


üëç‚Äî-------------------Fourth  Way ‚Äî------------------------------------üëç

import { NextFunction, Request, RequestHandler, Response } from "express"

const catchAsync = (fn: RequestHandler)=>{
    return (req: Request, res:Response, next:NextFunction)=>{
      Promise.resolve(fn(req, res, next)).catch((err)=> next(err))
    }
}

export default catchAsync;






‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá! ‡¶ö‡¶≤‡ßã step by step, venge venge (‡¶ß‡¶æ‡¶™‡ßá ‡¶ß‡¶æ‡¶™‡ßá) Bangla-te ‡¶¨‡ßÅ‡¶ù‡¶ø ‡¶è‡¶á asyncHandler function ‡¶ü‡¶ø ‡¶ï‡ßá‡¶Æ‡¶® ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá‡•§

1Ô∏è‚É£ Function Definition
export const asyncHandler = (
  fn: (req: Request, res: Response, next: NextFunction) => Promise<any>
)

‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ function ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶Ø‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ asyncHandler‡•§


‡¶è‡¶á function ‡¶è‡¶ï‡¶ü‡¶æ argument ‡¶®‡ßá‡ßü, ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶π‡¶≤‡ßã fn‡•§


fn ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ controller function, ‡¶Ø‡¶æ async ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá (promise return ‡¶ï‡¶∞‡ßá)‡•§


‡¶è‡¶á fn ‡ß©‡¶ü‡¶æ parameter ‡¶®‡ßá‡ßü:


req ‚Üí request object


res ‚Üí response object


next ‚Üí middleware/Express error handler-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø next function



2Ô∏è‚É£ Return ‡¶ï‡¶∞‡¶æ function
return (req: Request, res: Response, next: NextFunction) => {

asyncHandler return ‡¶ï‡¶∞‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶ï‡¶ü‡¶æ function, ‡¶Ø‡¶æ Express route ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§


Express ‡¶∏‡¶¨ route function-‡¶è ‡¶§‡¶ø‡¶®‡¶ü‡¶ø parameter ‡¶™‡¶æ‡¶†‡¶æ‡ßü: req, res, next‡•§


‡¶§‡¶æ‡¶á ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá‡¶ì ‡¶è‡¶ï‡¶á‡¶≠‡¶æ‡¶¨‡ßá ‡¶§‡¶ø‡¶®‡¶ü‡¶ø parameter ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø‡•§



3Ô∏è‚É£ Async function call & catch
fn(req, res, next).catch(next);

‡¶Ü‡¶Æ‡¶∞‡¶æ original fn function ‡¶ï‡ßá call ‡¶ï‡¶∞‡¶õ‡¶ø: fn(req, res, next)


‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ fn async (promise return ‡¶ï‡¶∞‡ßá), ‡¶Ü‡¶Æ‡¶∞‡¶æ .catch(next) ‡¶¶‡¶ø‡ßü‡ßá ‡¶¨‡¶≤‡¶õ‡¶ø:


 ‚Äú‡¶Ø‡¶¶‡¶ø fn execution-‡¶è‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶ï‡ßã‡¶®‡ßã error ‡¶π‡ßü (reject ‡¶π‡ßü), ‡¶§‡¶æ automatic next(error) ‡¶¶‡¶ø‡ßü‡ßá Express error handler-‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶ì‡•§‚Äù



‡¶Ö‡¶∞‡ßç‡¶•‡¶æ‡ßé manual try/catch ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶®‡ßá‡¶á‡•§



4Ô∏è‚É£ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ Flow
‡¶§‡ßÅ‡¶Æ‡¶ø route ‡¶è ‡¶≤‡¶ø‡¶ñ‡¶õ‡ßã:


app.get("/contacts", asyncHandler(getAllContacts));

‡¶Ø‡¶ñ‡¶® request ‡¶Ü‡¶∏‡ßá:


Express ‡¶Ü‡¶∏‡¶≤‡ßá call ‡¶ï‡¶∞‡ßá asyncHandler ‡¶è‡¶∞ return ‡¶ï‡¶∞‡¶æ function‡•§


‡¶∏‡ßá‡¶á function ‡¶ö‡¶æ‡¶≤‡¶æ‡ßü ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ getAllContacts(req, res, next)‡•§


‡¶Ø‡¶¶‡¶ø controller ‡¶†‡¶ø‡¶ï‡¶†‡¶æ‡¶ï ‡¶ö‡¶≤‡ßá ‚Üí response send ‡¶π‡ßü‡•§


‡¶Ø‡¶¶‡¶ø controller error throw ‡¶ï‡¶∞‡ßá ‚Üí .catch(next) automatically ‡¶∏‡ßá‡¶á error Express error middleware-‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡ßü‡•§



5Ô∏è‚É£ Bangla Summary
asyncHandler ‡¶π‡¶≤‡ßã wrapper function‡•§


‡¶è‡¶ü‡¶ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ async controller ‡¶ï‡ßá wrap ‡¶ï‡¶∞‡ßá, ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶¨ error ‡¶ï‡ßá automatically centralized error handler ‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡ßü‡•§


‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶Ü‡¶∞ try/catch ‡¶¨‡¶æ‡¶∞‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ñ‡¶§‡ßá ‡¶π‡ßü ‡¶®‡¶æ‡•§


Controllers clean, DRY, ‡¶è‡¶¨‡¶Ç scalable ‡¶π‡ßü‡•§



üí° ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£:
const getAllContacts = async (req: Request, res: Response) => {
  const contacts = await ContactService.getAll(); // ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá error ‡¶π‡ßü, next(error) automatically ‡¶ö‡¶≤‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá
  res.json({ success: true, data: contacts });
};

app.get("/contacts", asyncHandler(getAllContacts));

‡¶è‡¶ï‡¶¶‡¶Æ clean, ‡¶ï‡ßã‡¶®‡ßã try/catch ‡¶®‡ßá‡¶á‡•§


‡¶∏‡¶¨ error centralized handler ‡¶è ‡¶Ø‡¶æ‡¶¨‡ßá‡•§



‡¶Ø‡¶¶‡¶ø ‡¶ö‡¶æ‡¶ì, ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø flow diagram ‡¶¨‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø, ‡¶Ø‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá step by step request ‚Üí asyncHandler ‚Üí controller ‚Üí errorHandler ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá‡•§
‡¶ö‡¶æ‡¶ì ‡¶Ü‡¶Æ‡¶ø ‡¶∏‡ßá‡¶ü‡¶æ ‡¶¨‡¶æ‡¶®‡¶æ‡¶á?


‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá! ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶ß‡¶æ‡¶™‡ßá ‡¶ß‡¶æ‡¶™‡ßá ‡¶¨‡ßÅ‡¶ù‡¶ø‡•§ ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ú‡¶ø‡¶ú‡ßç‡¶û‡ßá‡¶∏ ‡¶ï‡¶∞‡ßá‡¶õ‡ßã:
(fn: RequestHandler) => ... ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡¶ø?
‡¶è‡¶ü‡¶æ TypeScript-‡¶è‡¶∞ type annotation‡•§ ‡¶ß‡¶æ‡¶™‡ßá ‡¶ß‡¶æ‡¶™‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶ï‡¶∞‡¶ø:

1Ô∏è‚É£ RequestHandler ‡¶ï‡¶ø?
RequestHandler ‡¶π‡¶≤‡ßã Express.js-‡¶è‡¶∞ type ‡¶Ø‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ route/controller function-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶π‡ßü‡•§
‡¶è‡¶ï‡¶ü‡¶æ RequestHandler function ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ ‡¶è‡¶∞‡¶ï‡¶Æ ‡¶¶‡ßá‡¶ñ‡¶æ‡ßü:
(req: Request, res: Response, next: NextFunction) => void | Promise<any>

req ‚Üí request object


res ‚Üí response object


next ‚Üí middleware-‡¶è‡¶∞ next function


return type: ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ void ‡¶¨‡¶æ Promise (‡¶Ø‡¶¶‡¶ø async ‡¶π‡ßü)



2Ô∏è‚É£ (fn: RequestHandler) ‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡¶ø?
asyncHandler(fn: RequestHandler)

‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¨‡¶≤‡¶õ‡¶ø: asyncHandler function ‡¶è‡¶ï‡¶ü‡¶ø argument ‡¶®‡ßá‡¶¨‡ßá, ‡¶Ø‡¶æ type ‡¶π‡¶¨‡ßá RequestHandler‡•§


‡¶∏‡¶π‡¶ú ‡¶ï‡¶•‡¶æ‡¶Ø‡¶º: ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã Express controller/function ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßã, ‡¶Ø‡¶æ req, res, next ‡¶®‡ßá‡¶Ø‡¶º‡•§



3Ô∏è‚É£ Arrow function ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá
(fn: RequestHandler) => { ... }

‡¶è‡¶á ‡¶Ö‡¶Ç‡¶∂‡¶ü‡¶ø ‡¶π‡¶≤‡ßã function type declaration‡•§


‡¶Ö‡¶∞‡ßç‡¶•: asyncHandler ‡¶π‡¶≤‡ßã ‡¶è‡¶ï‡¶ü‡¶ø function ‡¶Ø‡¶æ ‡¶è‡¶ï‡¶ü‡¶ø fn ‡¶®‡ßá‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶ø‡¶õ‡ßÅ return ‡¶ï‡¶∞‡¶¨‡ßá‡•§


Return value ‡¶π‡¶≤‡ßã: (req, res, next) => { fn(req,res,next).catch(next) }


‡¶è‡¶á return ‡¶ï‡¶∞‡¶æ function-‡¶ü‡¶æ‡¶á Express route ‡¶è ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶π‡ßü‡•§



4Ô∏è‚É£ ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£
const asyncHandler = (fn: RequestHandler) => {
  return (req, res, next) => {
    fn(req, res, next).catch(next);
  };
};

‡¶è‡¶ñ‡¶æ‡¶®‡ßá fn ‡¶π‡¶≤‡ßã ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ async controller


Arrow function (fn) => {...} ‡¶¨‡¶≤‡¶õ‡ßá: fn ‡¶¶‡¶æ‡¶ì ‚Üí ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® function ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø ‡¶Ø‡¶æ Express ‡¶è ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§



üí° ‡¶∏‡¶π‡¶ú‡¶≠‡¶æ‡¶¨‡ßá:
(fn: RequestHandler) => ... ‡¶Æ‡¶æ‡¶®‡ßá ‡¶π‡¶≤‡ßã:
 ‚Äú‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø function ‡¶¨‡¶æ‡¶®‡¶æ‡¶ö‡ßç‡¶õ‡¶ø ‡¶Ø‡¶æ ‡¶è‡¶ï‡¶ü‡¶ø Express controller (fn) ‡¶®‡ßá‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç return ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø function ‡¶Ø‡ßá‡¶ü‡¶ø request handle ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡•§‚Äù

‡¶Ø‡¶¶‡¶ø ‡¶ö‡¶æ‡¶ì, ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡ßã‡¶ü diagram ‡¶¨‡¶æ‡¶®‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø, ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá request ‚Üí asyncHandler ‚Üí controller ‚Üí errorHandler flow ‡¶ö‡¶≤‡ßá‡•§
‡¶ö‡¶æ‡¶ì ‡¶Ü‡¶Æ‡¶ø ‡¶∏‡ßá‡¶ü‡¶æ ‡¶¨‡¶æ‡¶®‡¶æ‡¶á?

‡¶π‡ßç‡¶Ø‡¶æ‡¶Å, ‡¶è‡¶ï‡¶¶‡¶Æ! üòÑ
asyncHandler ‡¶è‡¶ï‡¶ü‡¶ø Higher-Order Function (HOF)‡•§ ‡¶ß‡¶æ‡¶™‡ßá ‡¶ß‡¶æ‡¶™‡ßá ‡¶¨‡ßÅ‡¶ù‡¶ø:

1Ô∏è‚É£ Higher-Order Function ‡¶ï‡¶ø?
Higher-Order Function ‡¶π‡¶≤‡ßã ‡¶è‡¶Æ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø function ‡¶Ø‡¶æ:
‡¶è‡¶ï‡¶ü‡¶æ function ‡¶ï‡ßá argument ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶®‡ßá‡¶Ø‡¶º, ‡¶Ö‡¶•‡¶¨‡¶æ


‡¶´‡¶æ‡¶Ç‡¶∂‡¶® return ‡¶ï‡¶∞‡ßá, ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶â‡¶≠‡¶Ø‡¶º‡¶á‡•§


‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£:
const addLogging = (fn: Function) => {
  return (...args: any[]) => {
    console.log("Function called with:", args);
    return fn(...args);
  };
};

addLogging ‚Üí HOF


fn ‚Üí original function


Return ‚Üí ‡¶®‡¶§‡ßÅ‡¶® function (logging ‡¶∏‡¶π)



2Ô∏è‚É£ asyncHandler ‡¶ï‡ßá‡¶® HOF?
export const asyncHandler = (fn: RequestHandler) => {
  return (req: Request, res: Response, next: NextFunction) => {
    fn(req, res, next).catch(next);
  };
};

‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶ï‡¶ü‡¶æ function (fn) ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡¶ø‡•§ ‚úÖ


‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶®‡¶§‡ßÅ‡¶® function return ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶Ø‡¶æ Express route ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§ ‚úÖ


‡¶Ö‡¶∞‡ßç‡¶•‡¶æ‡ßé, asyncHandler:
Input ‚Üí ‡¶è‡¶ï‡¶ü‡¶ø controller function (fn)


Output ‚Üí ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® function ‡¶Ø‡¶æ request handle ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç error auto-forward ‡¶ï‡¶∞‡ßá



3Ô∏è‚É£ ‡¶∏‡¶π‡¶ú‡¶≠‡¶æ‡¶¨‡ßá ‡¶ß‡¶∞‡ßã
Controller (fn)
      ‚Üì
  asyncHandler(fn)
      ‚Üì
New Wrapped Controller (req, res, next) => { ... }

asyncHandler ‡¶π‡¶≤‡ßã wrapper ‡¶¨‡¶æ decorator function‡•§


Wrapper function-‡¶è‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶ï‡¶æ‡¶ú: extra behavior ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ, ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡ßá‡¶ü‡¶æ ‡¶π‡¶≤‡ßã automatic error handling‡•§



üí° ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™‡ßá:
‡¶Ø‡¶¶‡¶ø function function ‡¶®‡ßá‡¶Ø‡¶º ‡¶¨‡¶æ return ‡¶ï‡¶∞‡ßá, ‡¶∏‡ßá‡¶ü‡¶æ Higher-Order Function‡•§
 asyncHandler ‡¶†‡¶ø‡¶ï ‡¶∏‡ßá‡¶á ‡¶∞‡¶ï‡¶Æ ‚Äì ‡¶§‡¶æ‡¶á ‡¶è‡¶ü‡¶ø Higher-Order Function‡•§ ‚úÖ

‡¶Ø‡¶¶‡¶ø ‡¶ö‡¶æ‡¶ì, ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶π‡¶ú diagram ‡¶¨‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø ‡¶Ø‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá asyncHandler controller ‡¶ï‡ßá wrap ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç error auto-forward ‡¶ï‡¶∞‡ßá‡•§
‡¶ö‡¶æ‡¶ì ‡¶Ü‡¶Æ‡¶ø ‡¶¨‡¶æ‡¶®‡¶æ‡¶á?


‡¶π‡ßç‡¶Ø‡¶æ‡¶Å, ‡¶†‡¶ø‡¶ï‡¶á ‡¶ß‡¶∞‡ßá‡¶õ‡ßã! üòÑ

```ts
Promise.resolve(fn(req, res, next)).catch((err) => next(err))
```

‡¶è‡¶á ‡¶≤‡¶æ‡¶á‡¶®‡¶ü‡¶ø **`try/catch` ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶ú‡¶ü‡¶æ‡¶á ‡¶ï‡¶∞‡ßá**, ‡¶∂‡ßÅ‡¶ß‡ßÅ Promise/async style-‡¶è‡•§ ‡¶ß‡¶æ‡¶™‡ßá ‡¶ß‡¶æ‡¶™‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶ï‡¶∞‡¶ø:

---

### **1Ô∏è‚É£ Async function ‡¶è‡¶∞ behavior**

‡¶Ø‡¶¶‡¶ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ controller async ‡¶π‡ßü:

```ts
const getAllContacts = async (req, res) => {
  const contacts = await ContactService.getAll();
  res.json({ success: true, data: contacts });
};
```

* `async` function ‡¶∏‡¶∞‡ßç‡¶¨‡¶¶‡¶æ **Promise return ‡¶ï‡¶∞‡ßá**
* ‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶® `await` ‡¶¨‡¶æ function `throw` ‡¶ï‡¶∞‡ßá ‚Üí Promise **reject** ‡¶π‡ßü

---

### **2Ô∏è‚É£ Promise.resolve + catch**

```ts
Promise.resolve(fn(req, res, next)).catch(err => next(err));
```

* `Promise.resolve(fn(...))` ‚Üí ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá `fn` ‡¶∏‡¶¨‡¶∏‡¶Æ‡ßü **Promise** ‡¶π‡¶¨‡ßá
  (‡¶Ø‡¶¶‡¶ø normal function return ‡¶ï‡¶∞‡ßá, ‡¶§‡¶æ‡¶ì Promise ‡¶è wrap ‡¶ï‡¶∞‡ßá)
* `.catch(err => next(err))` ‚Üí ‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶®‡ßã error ‡¶ò‡¶ü‡ßá ‚Üí ‡¶∏‡ßá‡¶á error `next(err)` ‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá

üí° ‡¶Ö‡¶∞‡ßç‡¶•‡¶æ‡ßé:

```ts
try {
  await fn(req, res, next); // async code
} catch(err) {
  next(err); // error forward
}
```

‡¶è‡¶á try/catch block ‡¶ï‡ßá **Promise + .catch** ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá replace ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§

---

### **3Ô∏è‚É£ ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ**

* Controllers **clean** ‡¶•‡¶æ‡¶ï‡ßá, ‡¶ï‡ßã‡¶® try/catch ‡¶≤‡¶æ‡¶ó‡ßá‡¶®‡¶æ
* ‡¶∏‡¶¨ async error **automatic** centralized error handler-‡¶è ‡¶Ø‡¶æ‡ßü
* DRY principle ‡¶Æ‡¶æ‡¶®‡¶æ ‡¶π‡ßü

---

### **‡¶∏‡¶æ‡¶∞‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™**

> `Promise.resolve(fn(...)).catch(next)` ‡¶π‡¶≤‡ßã **try/catch ‡¶è‡¶∞ compact/modern Promise version**, ‡¶Ø‡¶æ async controller-‡¶è error handle ‡¶ï‡¶∞‡ßá‡•§

---

‡¶Ø‡¶¶‡¶ø ‡¶ö‡¶æ‡¶ì, ‡¶Ü‡¶Æ‡¶ø **‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡ßã‡¶ü diagram** ‡¶¨‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø ‡¶Ø‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá:

**request ‚Üí Promise.resolve(fn) ‚Üí catch ‚Üí next(error)**

‡¶è‡¶ü‡¶æ try/catch workflow ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶§‡ßÅ‡¶≤‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§

‡¶ö‡¶æ‡¶ì ‡¶Ü‡¶Æ‡¶ø ‡¶¨‡¶æ‡¶®‡¶æ‡¶á?


